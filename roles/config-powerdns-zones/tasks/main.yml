- name: Read global-config settings
  include_vars:
    dir: "{{ playbook_dir }}/global-config/"
    ignore_unknown_extensions: true

- name: "Template named.conf for PowerDNS"
  template:
    src: "named.conf.j2"
    dest: "/etc/powerdns/named.conf"
    mode: '0644'
  notify:
    - Reconfigure PowerDNS

- name: "Synchronize DNS zones"
  synchronize:
    src: "{{ playbook_dir }}/global-config/dns-zones/"
    dest: "{{ dns_zones_dir }}"
  notify:
    - Reconfigure PowerDNS
