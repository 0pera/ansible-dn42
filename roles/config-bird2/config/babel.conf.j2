protocol direct {
    ipv4;
    ipv6;
{% for entry in stub_ifnames + stub_ifnames_append|default([]) %}
    interface "{{ entry }}";
{% endfor %}
};

{% if babel_links is defined or inventory_hostname in igp_neighbours %}
protocol babel int_babel {
    randomize router id on;
    ipv4 {
        import where source != RTS_BGP && is_self_net();
        export where source != RTS_BGP && is_self_net();
    };
    ipv6 {
        import where source != RTS_BGP && is_self_net_v6();
        export where source != RTS_BGP && is_self_net_v6();
    };

    # Generated by Ansible
{% for host in igp_neighbours[inventory_hostname] | sort %}
{% set nodedata = hostvars[host] %}
    interface "igp-{{ nodedata['shortname'] }}" {
        rxcost
        include "{{ automation_root_dir }}/igpping/rxcost/{{ host }}.conf";;
    };
{% endfor %}

{% if babel_links is defined %}
{% for ifname, cost in babel_links.items() %}
    interface "{{ ifname }}" {
        rxcost {{ cost }};
    };
{% endfor %}
{% endif %}
};
{% endif %}
