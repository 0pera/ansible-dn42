# Import routes defined via loopback addresses
# https://bird.network.cz/pipermail/bird-users/2015-June/009720.html
protocol direct {
    ipv4;
    ipv6;
    interface "lo*", "tun*";
}

protocol ospf v3 int_ospf {
    ipv4 {
        import all;
        export where source != RTS_BGP;
    };
    area 0 {
        networks {
            # Peering LAN
            192.168.88.0/24;
            # Public dn42 ranges
            OWNNET;
            # Other infra (specific to my network)
            192.168.33.0/24;
        };
        interface "igp*" {
            # TODO: add cost based on igp_costs.yml
            cost 10;
            type ptp;
        };

        # Loopback interface on each machine
        interface "lo" {
            stub;
        };
    };
}

protocol ospf v3 int_ospf6 {
    ipv6 {
        import all;
        export where source != RTS_BGP;
    };
    area 0 {
        networks {
            OWNNETv6;
        };
        interface "igp*" {
            # TODO: add cost based on igp_costs.yml
            cost 10;
            type ptp;
        };

        # Loopback interface on each machine
        interface "lo" {
            stub;
        };

        # Separate VPN links
        interface "tun*" {
            stub;
        };
    };
}
