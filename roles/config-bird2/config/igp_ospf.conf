# Import routes defined via loopback addresses
# https://bird.network.cz/pipermail/bird-users/2015-June/009720.html
protocol direct {
    ipv4;
    ipv6;
    interface "lo*", "tun*";
}

protocol ospf v3 int_ospf {
    ipv4 {
        import where is_self_net();
        export where is_self_net();
    };
    area 0 {
        interface "igp*" {
            # TODO: add cost based on igp_costs.yml
            cost 10;
            type ptp;
        };

        # Loopback interface on each machine
        interface "lo" {
            stub;
        };

        # Separate VPN links
        interface "tun*" {
            stub;
        };
    };
}

protocol ospf v3 int_ospf6 {
    ipv6 {
        import where is_self_net_v6();
        export where is_self_net_v6();
    };
    area 0 {
        interface "igp*" {
            # TODO: add cost based on igp_costs.yml
            cost 10;
            type ptp;
        };

        # Loopback interface on each machine
        interface "lo" {
            stub;
        };

        # Separate VPN links
        interface "tun*" {
            stub;
        };
    };
}
